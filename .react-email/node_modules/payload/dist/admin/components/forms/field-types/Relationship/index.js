"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return _default;
    }
});
const _qs = /*#__PURE__*/ _interop_require_default(require("qs"));
const _react = /*#__PURE__*/ _interop_require_wildcard(require("react"));
const _reacti18next = require("react-i18next");
const _validations = require("../../../../../fields/validations");
const _wordBoundariesRegex = /*#__PURE__*/ _interop_require_default(require("../../../../../utilities/wordBoundariesRegex"));
const _useDebouncedCallback = require("../../../../hooks/useDebouncedCallback");
const _ReactSelect = /*#__PURE__*/ _interop_require_default(require("../../../elements/ReactSelect"));
const _Auth = require("../../../utilities/Auth");
const _Config = require("../../../utilities/Config");
const _GetFilterOptions = require("../../../utilities/GetFilterOptions");
const _Locale = require("../../../utilities/Locale");
const _Error = /*#__PURE__*/ _interop_require_default(require("../../Error"));
const _FieldDescription = /*#__PURE__*/ _interop_require_default(require("../../FieldDescription"));
const _context = require("../../Form/context");
const _Label = /*#__PURE__*/ _interop_require_default(require("../../Label"));
const _useField = /*#__PURE__*/ _interop_require_default(require("../../useField"));
const _withCondition = /*#__PURE__*/ _interop_require_default(require("../../withCondition"));
const _shared = require("../shared");
const _AddNew = require("./AddNew");
const _createRelationMap = require("./createRelationMap");
const _findOptionsByValue = require("./findOptionsByValue");
require("./index.scss");
const _optionsReducer = /*#__PURE__*/ _interop_require_default(require("./optionsReducer"));
const _MultiValueLabel = require("./select-components/MultiValueLabel");
const _SingleValue = require("./select-components/SingleValue");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {};
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
const maxResultsPerRequest = 10;
const baseClass = 'relationship';
const Relationship = (props)=>{
    const { name, admin: { allowCreate = true, className, components: { Error, Label } = {}, condition, description, isSortable = true, readOnly, sortOptions, style, width } = {}, filterOptions, hasMany, label, path, relationTo, required, validate = _validations.relationship } = props;
    const ErrorComp = Error || _Error.default;
    const LabelComp = Label || _Label.default;
    const config = (0, _Config.useConfig)();
    const { collections, routes: { api }, serverURL } = config;
    const { i18n, t } = (0, _reacti18next.useTranslation)('fields');
    const { permissions } = (0, _Auth.useAuth)();
    const { code: locale } = (0, _Locale.useLocale)();
    const formProcessing = (0, _context.useFormProcessing)();
    const hasMultipleRelations = Array.isArray(relationTo);
    const [options, dispatchOptions] = (0, _react.useReducer)(_optionsReducer.default, []);
    const [lastFullyLoadedRelation, setLastFullyLoadedRelation] = (0, _react.useState)(-1);
    const [lastLoadedPage, setLastLoadedPage] = (0, _react.useState)({});
    const [errorLoading, setErrorLoading] = (0, _react.useState)('');
    const [filterOptionsResult, setFilterOptionsResult] = (0, _react.useState)();
    const [search, setSearch] = (0, _react.useState)('');
    const [isLoading, setIsLoading] = (0, _react.useState)(false);
    const [hasLoadedFirstPage, setHasLoadedFirstPage] = (0, _react.useState)(false);
    const [enableWordBoundarySearch, setEnableWordBoundarySearch] = (0, _react.useState)(false);
    const firstRun = (0, _react.useRef)(true);
    const pathOrName = path || name;
    const memoizedValidate = (0, _react.useCallback)((value, validationOptions)=>{
        return validate(value, {
            ...validationOptions,
            required
        });
    }, [
        validate,
        required
    ]);
    const { errorMessage, initialValue, setValue, showError, value } = (0, _useField.default)({
        condition,
        path: pathOrName,
        validate: memoizedValidate
    });
    const [drawerIsOpen, setDrawerIsOpen] = (0, _react.useState)(false);
    const getResults = (0, _react.useCallback)(async ({ lastFullyLoadedRelation: lastFullyLoadedRelationArg, onSuccess, search: searchArg, sort, value: valueArg })=>{
        if (!permissions) {
            return;
        }
        const lastFullyLoadedRelationToUse = typeof lastFullyLoadedRelationArg !== 'undefined' ? lastFullyLoadedRelationArg : -1;
        const relations = Array.isArray(relationTo) ? relationTo : [
            relationTo
        ];
        const relationsToFetch = lastFullyLoadedRelationToUse === -1 ? relations : relations.slice(lastFullyLoadedRelationToUse + 1);
        let resultsFetched = 0;
        const relationMap = (0, _createRelationMap.createRelationMap)({
            hasMany,
            relationTo,
            value: valueArg
        });
        if (!errorLoading) {
            relationsToFetch.reduce(async (priorRelation, relation)=>{
                const relationFilterOption = filterOptionsResult?.[relation];
                let lastLoadedPageToUse;
                if (search !== searchArg) {
                    lastLoadedPageToUse = 1;
                } else {
                    lastLoadedPageToUse = lastLoadedPage[relation] + 1;
                }
                await priorRelation;
                if (relationFilterOption === false) {
                    setLastFullyLoadedRelation(relations.indexOf(relation));
                    return Promise.resolve();
                }
                if (resultsFetched < 10) {
                    const collection = collections.find((coll)=>coll.slug === relation);
                    let fieldToSearch = collection?.defaultSort || collection?.admin?.useAsTitle || 'id';
                    if (!searchArg) {
                        if (typeof sortOptions === 'string') {
                            fieldToSearch = sortOptions;
                        } else if (sortOptions?.[relation]) {
                            fieldToSearch = sortOptions[relation];
                        }
                    }
                    const query = {
                        depth: 0,
                        draft: true,
                        limit: maxResultsPerRequest,
                        locale,
                        page: lastLoadedPageToUse,
                        sort: fieldToSearch,
                        where: {
                            and: [
                                {
                                    id: {
                                        not_in: relationMap[relation]
                                    }
                                }
                            ]
                        }
                    };
                    if (searchArg) {
                        query.where.and.push({
                            [fieldToSearch]: {
                                like: searchArg
                            }
                        });
                    }
                    if (relationFilterOption && typeof relationFilterOption !== 'boolean') {
                        query.where.and.push(relationFilterOption);
                    }
                    const response = await fetch(`${serverURL}${api}/${relation}?${_qs.default.stringify(query)}`, {
                        credentials: 'include',
                        headers: {
                            'Accept-Language': i18n.language
                        }
                    });
                    if (response.ok) {
                        const data = await response.json();
                        setLastLoadedPage((prevState)=>{
                            return {
                                ...prevState,
                                [relation]: lastLoadedPageToUse
                            };
                        });
                        if (!data.nextPage) {
                            setLastFullyLoadedRelation(relations.indexOf(relation));
                        }
                        if (data.docs.length > 0) {
                            resultsFetched += data.docs.length;
                            dispatchOptions({
                                type: 'ADD',
                                collection,
                                config,
                                docs: data.docs,
                                i18n,
                                sort
                            });
                        }
                    } else if (response.status === 403) {
                        setLastFullyLoadedRelation(relations.indexOf(relation));
                        dispatchOptions({
                            type: 'ADD',
                            collection,
                            config,
                            docs: [],
                            i18n,
                            ids: relationMap[relation],
                            sort
                        });
                    } else {
                        setErrorLoading(t('error:unspecific'));
                    }
                }
            }, Promise.resolve());
            if (typeof onSuccess === 'function') onSuccess();
        }
    }, [
        permissions,
        relationTo,
        hasMany,
        errorLoading,
        search,
        lastLoadedPage,
        collections,
        locale,
        filterOptionsResult,
        serverURL,
        sortOptions,
        api,
        i18n,
        config,
        t
    ]);
    const updateSearch = (0, _useDebouncedCallback.useDebouncedCallback)((searchArg, valueArg)=>{
        getResults({
            search: searchArg,
            sort: true,
            value: valueArg
        });
        setSearch(searchArg);
    }, 300);
    const handleInputChange = (0, _react.useCallback)((searchArg, valueArg)=>{
        if (search !== searchArg) {
            setLastLoadedPage({});
            updateSearch(searchArg, valueArg, searchArg !== '');
        }
    }, [
        search,
        updateSearch
    ]);
    // ///////////////////////////////////
    // Ensure we have an option for each value
    // ///////////////////////////////////
    (0, _react.useEffect)(()=>{
        const relationMap = (0, _createRelationMap.createRelationMap)({
            hasMany,
            relationTo,
            value
        });
        Object.entries(relationMap).reduce(async (priorRelation, [relation, ids])=>{
            await priorRelation;
            const idsToLoad = ids.filter((id)=>{
                return !options.find((optionGroup)=>optionGroup?.options?.find((option)=>option.value === id && option.relationTo === relation));
            });
            if (idsToLoad.length > 0) {
                const query = {
                    depth: 0,
                    draft: true,
                    limit: idsToLoad.length,
                    locale,
                    where: {
                        id: {
                            in: idsToLoad
                        }
                    }
                };
                if (!errorLoading) {
                    const response = await fetch(`${serverURL}${api}/${relation}?${_qs.default.stringify(query)}`, {
                        credentials: 'include',
                        headers: {
                            'Accept-Language': i18n.language
                        }
                    });
                    const collection = collections.find((coll)=>coll.slug === relation);
                    let docs = [];
                    if (response.ok) {
                        const data = await response.json();
                        docs = data.docs;
                    }
                    dispatchOptions({
                        type: 'ADD',
                        collection,
                        config,
                        docs,
                        i18n,
                        ids: idsToLoad,
                        sort: true
                    });
                }
            }
        }, Promise.resolve());
    }, [
        options,
        value,
        hasMany,
        errorLoading,
        collections,
        hasMultipleRelations,
        serverURL,
        api,
        i18n,
        relationTo,
        locale,
        config
    ]);
    // Determine if we should switch to word boundary search
    (0, _react.useEffect)(()=>{
        const relations = Array.isArray(relationTo) ? relationTo : [
            relationTo
        ];
        const isIdOnly = relations.reduce((idOnly, relation)=>{
            const collection = collections.find((coll)=>coll.slug === relation);
            const fieldToSearch = collection?.admin?.useAsTitle || 'id';
            return fieldToSearch === 'id' && idOnly;
        }, true);
        setEnableWordBoundarySearch(!isIdOnly);
    }, [
        relationTo,
        collections
    ]);
    // When (`relationTo` || `filterOptionsResult` || `locale`) changes, reset component
    // Note - effect should not run on first run
    (0, _react.useEffect)(()=>{
        if (firstRun.current) {
            firstRun.current = false;
            return;
        }
        dispatchOptions({
            type: 'CLEAR'
        });
        setLastFullyLoadedRelation(-1);
        setLastLoadedPage({});
        setHasLoadedFirstPage(false);
    }, [
        relationTo,
        filterOptionsResult,
        locale
    ]);
    const onSave = (0, _react.useCallback)((args)=>{
        dispatchOptions({
            type: 'UPDATE',
            collection: args.collectionConfig,
            config,
            doc: args.doc,
            i18n
        });
    }, [
        i18n,
        config
    ]);
    const filterOption = (0, _react.useCallback)((item, searchFilter)=>{
        if (!searchFilter) {
            return true;
        }
        const r = (0, _wordBoundariesRegex.default)(searchFilter || '');
        // breaking the labels to search into smaller parts increases performance
        const breakApartThreshold = 250;
        let string = item.label;
        // strings less than breakApartThreshold length won't be chunked
        while(string.length > breakApartThreshold){
            // slicing by the next space after the length of the search input prevents slicing the string up by partial words
            const indexOfSpace = string.indexOf(' ', searchFilter.length);
            if (r.test(string.slice(0, indexOfSpace === -1 ? searchFilter.length : indexOfSpace + 1))) {
                return true;
            }
            string = string.slice(indexOfSpace === -1 ? searchFilter.length : indexOfSpace + 1);
        }
        return r.test(string.slice(-breakApartThreshold));
    }, []);
    const valueToRender = (0, _findOptionsByValue.findOptionsByValue)({
        options,
        value
    });
    if (!Array.isArray(valueToRender) && valueToRender?.value === 'null') valueToRender.value = null;
    return /*#__PURE__*/ _react.default.createElement("div", {
        className: [
            _shared.fieldBaseClass,
            baseClass,
            className,
            showError && 'error',
            errorLoading && 'error-loading',
            readOnly && `${baseClass}--read-only`
        ].filter(Boolean).join(' '),
        id: `field-${pathOrName.replace(/\./g, '__')}`,
        style: {
            ...style,
            width
        }
    }, /*#__PURE__*/ _react.default.createElement(ErrorComp, {
        message: errorMessage,
        showError: showError
    }), /*#__PURE__*/ _react.default.createElement(LabelComp, {
        htmlFor: pathOrName,
        label: label,
        required: required
    }), /*#__PURE__*/ _react.default.createElement(_GetFilterOptions.GetFilterOptions, {
        filterOptions,
        filterOptionsResult,
        path: pathOrName,
        relationTo,
        setFilterOptionsResult
    }), !errorLoading && /*#__PURE__*/ _react.default.createElement("div", {
        className: `${baseClass}__wrap`
    }, /*#__PURE__*/ _react.default.createElement(_ReactSelect.default, {
        backspaceRemovesValue: !drawerIsOpen,
        components: {
            MultiValueLabel: _MultiValueLabel.MultiValueLabel,
            SingleValue: _SingleValue.SingleValue
        },
        customProps: {
            disableKeyDown: drawerIsOpen,
            disableMouseDown: drawerIsOpen,
            onSave,
            setDrawerIsOpen
        },
        disabled: readOnly || formProcessing,
        filterOption: enableWordBoundarySearch ? filterOption : undefined,
        isLoading: isLoading,
        isMulti: hasMany,
        isSortable: isSortable,
        onChange: !readOnly ? (selected)=>{
            if (selected === null) {
                setValue(hasMany ? [] : null);
            } else if (hasMany) {
                setValue(selected ? selected.map((option)=>{
                    if (hasMultipleRelations) {
                        return {
                            relationTo: option.relationTo,
                            value: option.value
                        };
                    }
                    return option.value;
                }) : null);
            } else if (hasMultipleRelations) {
                setValue({
                    relationTo: selected.relationTo,
                    value: selected.value
                });
            } else {
                setValue(selected.value);
            }
        } : undefined,
        onInputChange: (newSearch)=>handleInputChange(newSearch, value),
        onMenuOpen: ()=>{
            if (!hasLoadedFirstPage) {
                setIsLoading(true);
                getResults({
                    onSuccess: ()=>{
                        setHasLoadedFirstPage(true);
                        setIsLoading(false);
                    },
                    value: initialValue
                });
            }
        },
        onMenuScrollToBottom: ()=>{
            getResults({
                lastFullyLoadedRelation,
                search,
                sort: false,
                value: initialValue
            });
        },
        options: options,
        showError: showError,
        value: valueToRender ?? null
    }), !readOnly && allowCreate && /*#__PURE__*/ _react.default.createElement(_AddNew.AddNewRelation, {
        dispatchOptions,
        hasMany,
        options,
        path: pathOrName,
        relationTo,
        setValue,
        value
    })), errorLoading && /*#__PURE__*/ _react.default.createElement("div", {
        className: `${baseClass}__error-loading`
    }, errorLoading), /*#__PURE__*/ _react.default.createElement(_FieldDescription.default, {
        description: description,
        path: path,
        value: value
    }));
};
const _default = (0, _withCondition.default)(Relationship);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9hZG1pbi9jb21wb25lbnRzL2Zvcm1zL2ZpZWxkLXR5cGVzL1JlbGF0aW9uc2hpcC9pbmRleC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHFzIGZyb20gJ3FzJ1xuaW1wb3J0IFJlYWN0LCB7IHVzZUNhbGxiYWNrLCB1c2VFZmZlY3QsIHVzZVJlZHVjZXIsIHVzZVJlZiwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCdcbmltcG9ydCB7IHVzZVRyYW5zbGF0aW9uIH0gZnJvbSAncmVhY3QtaTE4bmV4dCdcblxuaW1wb3J0IHR5cGUgeyBQYWdpbmF0ZWREb2NzIH0gZnJvbSAnLi4vLi4vLi4vLi4vLi4vZGF0YWJhc2UvdHlwZXMnXG5pbXBvcnQgdHlwZSB7IFdoZXJlIH0gZnJvbSAnLi4vLi4vLi4vLi4vLi4vdHlwZXMnXG5pbXBvcnQgdHlwZSB7IERvY3VtZW50RHJhd2VyUHJvcHMgfSBmcm9tICcuLi8uLi8uLi9lbGVtZW50cy9Eb2N1bWVudERyYXdlci90eXBlcydcbmltcG9ydCB0eXBlIHsgRmlsdGVyT3B0aW9uc1Jlc3VsdCwgR2V0UmVzdWx0cywgT3B0aW9uLCBQcm9wcywgVmFsdWUgfSBmcm9tICcuL3R5cGVzJ1xuXG5pbXBvcnQgeyByZWxhdGlvbnNoaXAgfSBmcm9tICcuLi8uLi8uLi8uLi8uLi9maWVsZHMvdmFsaWRhdGlvbnMnXG5pbXBvcnQgd29yZEJvdW5kYXJpZXNSZWdleCBmcm9tICcuLi8uLi8uLi8uLi8uLi91dGlsaXRpZXMvd29yZEJvdW5kYXJpZXNSZWdleCdcbmltcG9ydCB7IHVzZURlYm91bmNlZENhbGxiYWNrIH0gZnJvbSAnLi4vLi4vLi4vLi4vaG9va3MvdXNlRGVib3VuY2VkQ2FsbGJhY2snXG5pbXBvcnQgUmVhY3RTZWxlY3QgZnJvbSAnLi4vLi4vLi4vZWxlbWVudHMvUmVhY3RTZWxlY3QnXG5pbXBvcnQgeyB1c2VBdXRoIH0gZnJvbSAnLi4vLi4vLi4vdXRpbGl0aWVzL0F1dGgnXG5pbXBvcnQgeyB1c2VDb25maWcgfSBmcm9tICcuLi8uLi8uLi91dGlsaXRpZXMvQ29uZmlnJ1xuaW1wb3J0IHsgR2V0RmlsdGVyT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uL3V0aWxpdGllcy9HZXRGaWx0ZXJPcHRpb25zJ1xuaW1wb3J0IHsgdXNlTG9jYWxlIH0gZnJvbSAnLi4vLi4vLi4vdXRpbGl0aWVzL0xvY2FsZSdcbmltcG9ydCBEZWZhdWx0RXJyb3IgZnJvbSAnLi4vLi4vRXJyb3InXG5pbXBvcnQgRmllbGREZXNjcmlwdGlvbiBmcm9tICcuLi8uLi9GaWVsZERlc2NyaXB0aW9uJ1xuaW1wb3J0IHsgdXNlRm9ybVByb2Nlc3NpbmcgfSBmcm9tICcuLi8uLi9Gb3JtL2NvbnRleHQnXG5pbXBvcnQgRGVmYXVsdExhYmVsIGZyb20gJy4uLy4uL0xhYmVsJ1xuaW1wb3J0IHVzZUZpZWxkIGZyb20gJy4uLy4uL3VzZUZpZWxkJ1xuaW1wb3J0IHdpdGhDb25kaXRpb24gZnJvbSAnLi4vLi4vd2l0aENvbmRpdGlvbidcbmltcG9ydCB7IGZpZWxkQmFzZUNsYXNzIH0gZnJvbSAnLi4vc2hhcmVkJ1xuaW1wb3J0IHsgQWRkTmV3UmVsYXRpb24gfSBmcm9tICcuL0FkZE5ldydcbmltcG9ydCB7IGNyZWF0ZVJlbGF0aW9uTWFwIH0gZnJvbSAnLi9jcmVhdGVSZWxhdGlvbk1hcCdcbmltcG9ydCB7IGZpbmRPcHRpb25zQnlWYWx1ZSB9IGZyb20gJy4vZmluZE9wdGlvbnNCeVZhbHVlJ1xuaW1wb3J0ICcuL2luZGV4LnNjc3MnXG5pbXBvcnQgb3B0aW9uc1JlZHVjZXIgZnJvbSAnLi9vcHRpb25zUmVkdWNlcidcbmltcG9ydCB7IE11bHRpVmFsdWVMYWJlbCB9IGZyb20gJy4vc2VsZWN0LWNvbXBvbmVudHMvTXVsdGlWYWx1ZUxhYmVsJ1xuaW1wb3J0IHsgU2luZ2xlVmFsdWUgfSBmcm9tICcuL3NlbGVjdC1jb21wb25lbnRzL1NpbmdsZVZhbHVlJ1xuXG5jb25zdCBtYXhSZXN1bHRzUGVyUmVxdWVzdCA9IDEwXG5cbmNvbnN0IGJhc2VDbGFzcyA9ICdyZWxhdGlvbnNoaXAnXG5cbmNvbnN0IFJlbGF0aW9uc2hpcDogUmVhY3QuRkM8UHJvcHM+ID0gKHByb3BzKSA9PiB7XG4gIGNvbnN0IHtcbiAgICBuYW1lLFxuICAgIGFkbWluOiB7XG4gICAgICBhbGxvd0NyZWF0ZSA9IHRydWUsXG4gICAgICBjbGFzc05hbWUsXG4gICAgICBjb21wb25lbnRzOiB7IEVycm9yLCBMYWJlbCB9ID0ge30sXG4gICAgICBjb25kaXRpb24sXG4gICAgICBkZXNjcmlwdGlvbixcbiAgICAgIGlzU29ydGFibGUgPSB0cnVlLFxuICAgICAgcmVhZE9ubHksXG4gICAgICBzb3J0T3B0aW9ucyxcbiAgICAgIHN0eWxlLFxuICAgICAgd2lkdGgsXG4gICAgfSA9IHt9LFxuICAgIGZpbHRlck9wdGlvbnMsXG4gICAgaGFzTWFueSxcbiAgICBsYWJlbCxcbiAgICBwYXRoLFxuICAgIHJlbGF0aW9uVG8sXG4gICAgcmVxdWlyZWQsXG4gICAgdmFsaWRhdGUgPSByZWxhdGlvbnNoaXAsXG4gIH0gPSBwcm9wc1xuXG4gIGNvbnN0IEVycm9yQ29tcCA9IEVycm9yIHx8IERlZmF1bHRFcnJvclxuICBjb25zdCBMYWJlbENvbXAgPSBMYWJlbCB8fCBEZWZhdWx0TGFiZWxcblxuICBjb25zdCBjb25maWcgPSB1c2VDb25maWcoKVxuXG4gIGNvbnN0IHtcbiAgICBjb2xsZWN0aW9ucyxcbiAgICByb3V0ZXM6IHsgYXBpIH0sXG4gICAgc2VydmVyVVJMLFxuICB9ID0gY29uZmlnXG5cbiAgY29uc3QgeyBpMThuLCB0IH0gPSB1c2VUcmFuc2xhdGlvbignZmllbGRzJylcbiAgY29uc3QgeyBwZXJtaXNzaW9ucyB9ID0gdXNlQXV0aCgpXG4gIGNvbnN0IHsgY29kZTogbG9jYWxlIH0gPSB1c2VMb2NhbGUoKVxuICBjb25zdCBmb3JtUHJvY2Vzc2luZyA9IHVzZUZvcm1Qcm9jZXNzaW5nKClcbiAgY29uc3QgaGFzTXVsdGlwbGVSZWxhdGlvbnMgPSBBcnJheS5pc0FycmF5KHJlbGF0aW9uVG8pXG4gIGNvbnN0IFtvcHRpb25zLCBkaXNwYXRjaE9wdGlvbnNdID0gdXNlUmVkdWNlcihvcHRpb25zUmVkdWNlciwgW10pXG4gIGNvbnN0IFtsYXN0RnVsbHlMb2FkZWRSZWxhdGlvbiwgc2V0TGFzdEZ1bGx5TG9hZGVkUmVsYXRpb25dID0gdXNlU3RhdGUoLTEpXG4gIGNvbnN0IFtsYXN0TG9hZGVkUGFnZSwgc2V0TGFzdExvYWRlZFBhZ2VdID0gdXNlU3RhdGU8UmVjb3JkPHN0cmluZywgbnVtYmVyPj4oe30pXG4gIGNvbnN0IFtlcnJvckxvYWRpbmcsIHNldEVycm9yTG9hZGluZ10gPSB1c2VTdGF0ZSgnJylcbiAgY29uc3QgW2ZpbHRlck9wdGlvbnNSZXN1bHQsIHNldEZpbHRlck9wdGlvbnNSZXN1bHRdID0gdXNlU3RhdGU8RmlsdGVyT3B0aW9uc1Jlc3VsdD4oKVxuICBjb25zdCBbc2VhcmNoLCBzZXRTZWFyY2hdID0gdXNlU3RhdGUoJycpXG4gIGNvbnN0IFtpc0xvYWRpbmcsIHNldElzTG9hZGluZ10gPSB1c2VTdGF0ZShmYWxzZSlcbiAgY29uc3QgW2hhc0xvYWRlZEZpcnN0UGFnZSwgc2V0SGFzTG9hZGVkRmlyc3RQYWdlXSA9IHVzZVN0YXRlKGZhbHNlKVxuICBjb25zdCBbZW5hYmxlV29yZEJvdW5kYXJ5U2VhcmNoLCBzZXRFbmFibGVXb3JkQm91bmRhcnlTZWFyY2hdID0gdXNlU3RhdGUoZmFsc2UpXG4gIGNvbnN0IGZpcnN0UnVuID0gdXNlUmVmKHRydWUpXG4gIGNvbnN0IHBhdGhPck5hbWUgPSBwYXRoIHx8IG5hbWVcblxuICBjb25zdCBtZW1vaXplZFZhbGlkYXRlID0gdXNlQ2FsbGJhY2soXG4gICAgKHZhbHVlLCB2YWxpZGF0aW9uT3B0aW9ucykgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlKHZhbHVlLCB7IC4uLnZhbGlkYXRpb25PcHRpb25zLCByZXF1aXJlZCB9KVxuICAgIH0sXG4gICAgW3ZhbGlkYXRlLCByZXF1aXJlZF0sXG4gIClcblxuICBjb25zdCB7IGVycm9yTWVzc2FnZSwgaW5pdGlhbFZhbHVlLCBzZXRWYWx1ZSwgc2hvd0Vycm9yLCB2YWx1ZSB9ID0gdXNlRmllbGQ8VmFsdWUgfCBWYWx1ZVtdPih7XG4gICAgY29uZGl0aW9uLFxuICAgIHBhdGg6IHBhdGhPck5hbWUsXG4gICAgdmFsaWRhdGU6IG1lbW9pemVkVmFsaWRhdGUsXG4gIH0pXG5cbiAgY29uc3QgW2RyYXdlcklzT3Blbiwgc2V0RHJhd2VySXNPcGVuXSA9IHVzZVN0YXRlKGZhbHNlKVxuXG4gIGNvbnN0IGdldFJlc3VsdHM6IEdldFJlc3VsdHMgPSB1c2VDYWxsYmFjayhcbiAgICBhc3luYyAoe1xuICAgICAgbGFzdEZ1bGx5TG9hZGVkUmVsYXRpb246IGxhc3RGdWxseUxvYWRlZFJlbGF0aW9uQXJnLFxuICAgICAgb25TdWNjZXNzLFxuICAgICAgc2VhcmNoOiBzZWFyY2hBcmcsXG4gICAgICBzb3J0LFxuICAgICAgdmFsdWU6IHZhbHVlQXJnLFxuICAgIH0pID0+IHtcbiAgICAgIGlmICghcGVybWlzc2lvbnMpIHtcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICBjb25zdCBsYXN0RnVsbHlMb2FkZWRSZWxhdGlvblRvVXNlID1cbiAgICAgICAgdHlwZW9mIGxhc3RGdWxseUxvYWRlZFJlbGF0aW9uQXJnICE9PSAndW5kZWZpbmVkJyA/IGxhc3RGdWxseUxvYWRlZFJlbGF0aW9uQXJnIDogLTFcblxuICAgICAgY29uc3QgcmVsYXRpb25zID0gQXJyYXkuaXNBcnJheShyZWxhdGlvblRvKSA/IHJlbGF0aW9uVG8gOiBbcmVsYXRpb25Ub11cbiAgICAgIGNvbnN0IHJlbGF0aW9uc1RvRmV0Y2ggPVxuICAgICAgICBsYXN0RnVsbHlMb2FkZWRSZWxhdGlvblRvVXNlID09PSAtMVxuICAgICAgICAgID8gcmVsYXRpb25zXG4gICAgICAgICAgOiByZWxhdGlvbnMuc2xpY2UobGFzdEZ1bGx5TG9hZGVkUmVsYXRpb25Ub1VzZSArIDEpXG5cbiAgICAgIGxldCByZXN1bHRzRmV0Y2hlZCA9IDBcbiAgICAgIGNvbnN0IHJlbGF0aW9uTWFwID0gY3JlYXRlUmVsYXRpb25NYXAoe1xuICAgICAgICBoYXNNYW55LFxuICAgICAgICByZWxhdGlvblRvLFxuICAgICAgICB2YWx1ZTogdmFsdWVBcmcsXG4gICAgICB9KVxuXG4gICAgICBpZiAoIWVycm9yTG9hZGluZykge1xuICAgICAgICByZWxhdGlvbnNUb0ZldGNoLnJlZHVjZShhc3luYyAocHJpb3JSZWxhdGlvbiwgcmVsYXRpb24pID0+IHtcbiAgICAgICAgICBjb25zdCByZWxhdGlvbkZpbHRlck9wdGlvbiA9IGZpbHRlck9wdGlvbnNSZXN1bHQ/LltyZWxhdGlvbl1cbiAgICAgICAgICBsZXQgbGFzdExvYWRlZFBhZ2VUb1VzZVxuICAgICAgICAgIGlmIChzZWFyY2ggIT09IHNlYXJjaEFyZykge1xuICAgICAgICAgICAgbGFzdExvYWRlZFBhZ2VUb1VzZSA9IDFcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGFzdExvYWRlZFBhZ2VUb1VzZSA9IGxhc3RMb2FkZWRQYWdlW3JlbGF0aW9uXSArIDFcbiAgICAgICAgICB9XG4gICAgICAgICAgYXdhaXQgcHJpb3JSZWxhdGlvblxuXG4gICAgICAgICAgaWYgKHJlbGF0aW9uRmlsdGVyT3B0aW9uID09PSBmYWxzZSkge1xuICAgICAgICAgICAgc2V0TGFzdEZ1bGx5TG9hZGVkUmVsYXRpb24ocmVsYXRpb25zLmluZGV4T2YocmVsYXRpb24pKVxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHJlc3VsdHNGZXRjaGVkIDwgMTApIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbGxlY3Rpb24gPSBjb2xsZWN0aW9ucy5maW5kKChjb2xsKSA9PiBjb2xsLnNsdWcgPT09IHJlbGF0aW9uKVxuICAgICAgICAgICAgbGV0IGZpZWxkVG9TZWFyY2ggPSBjb2xsZWN0aW9uPy5kZWZhdWx0U29ydCB8fCBjb2xsZWN0aW9uPy5hZG1pbj8udXNlQXNUaXRsZSB8fCAnaWQnXG4gICAgICAgICAgICBpZiAoIXNlYXJjaEFyZykge1xuICAgICAgICAgICAgICBpZiAodHlwZW9mIHNvcnRPcHRpb25zID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIGZpZWxkVG9TZWFyY2ggPSBzb3J0T3B0aW9uc1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNvcnRPcHRpb25zPy5bcmVsYXRpb25dKSB7XG4gICAgICAgICAgICAgICAgZmllbGRUb1NlYXJjaCA9IHNvcnRPcHRpb25zW3JlbGF0aW9uXVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHF1ZXJ5OiB7XG4gICAgICAgICAgICAgIFtrZXk6IHN0cmluZ106IHVua25vd25cbiAgICAgICAgICAgICAgd2hlcmU6IFdoZXJlXG4gICAgICAgICAgICB9ID0ge1xuICAgICAgICAgICAgICBkZXB0aDogMCxcbiAgICAgICAgICAgICAgZHJhZnQ6IHRydWUsXG4gICAgICAgICAgICAgIGxpbWl0OiBtYXhSZXN1bHRzUGVyUmVxdWVzdCxcbiAgICAgICAgICAgICAgbG9jYWxlLFxuICAgICAgICAgICAgICBwYWdlOiBsYXN0TG9hZGVkUGFnZVRvVXNlLFxuICAgICAgICAgICAgICBzb3J0OiBmaWVsZFRvU2VhcmNoLFxuICAgICAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgICAgIGFuZDogW1xuICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBpZDoge1xuICAgICAgICAgICAgICAgICAgICAgIG5vdF9pbjogcmVsYXRpb25NYXBbcmVsYXRpb25dLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoc2VhcmNoQXJnKSB7XG4gICAgICAgICAgICAgIHF1ZXJ5LndoZXJlLmFuZC5wdXNoKHtcbiAgICAgICAgICAgICAgICBbZmllbGRUb1NlYXJjaF06IHtcbiAgICAgICAgICAgICAgICAgIGxpa2U6IHNlYXJjaEFyZyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAocmVsYXRpb25GaWx0ZXJPcHRpb24gJiYgdHlwZW9mIHJlbGF0aW9uRmlsdGVyT3B0aW9uICE9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgICAgcXVlcnkud2hlcmUuYW5kLnB1c2gocmVsYXRpb25GaWx0ZXJPcHRpb24pXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7c2VydmVyVVJMfSR7YXBpfS8ke3JlbGF0aW9ufT8ke3FzLnN0cmluZ2lmeShxdWVyeSl9YCwge1xuICAgICAgICAgICAgICBjcmVkZW50aWFsczogJ2luY2x1ZGUnLFxuICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ0FjY2VwdC1MYW5ndWFnZSc6IGkxOG4ubGFuZ3VhZ2UsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgY29uc3QgZGF0YTogUGFnaW5hdGVkRG9jczx1bmtub3duPiA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuICAgICAgICAgICAgICBzZXRMYXN0TG9hZGVkUGFnZSgocHJldlN0YXRlKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgIC4uLnByZXZTdGF0ZSxcbiAgICAgICAgICAgICAgICAgIFtyZWxhdGlvbl06IGxhc3RMb2FkZWRQYWdlVG9Vc2UsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgIGlmICghZGF0YS5uZXh0UGFnZSkge1xuICAgICAgICAgICAgICAgIHNldExhc3RGdWxseUxvYWRlZFJlbGF0aW9uKHJlbGF0aW9ucy5pbmRleE9mKHJlbGF0aW9uKSlcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChkYXRhLmRvY3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdHNGZXRjaGVkICs9IGRhdGEuZG9jcy5sZW5ndGhcblxuICAgICAgICAgICAgICAgIGRpc3BhdGNoT3B0aW9ucyh7XG4gICAgICAgICAgICAgICAgICB0eXBlOiAnQUREJyxcbiAgICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24sXG4gICAgICAgICAgICAgICAgICBjb25maWcsXG4gICAgICAgICAgICAgICAgICBkb2NzOiBkYXRhLmRvY3MsXG4gICAgICAgICAgICAgICAgICBpMThuLFxuICAgICAgICAgICAgICAgICAgc29ydCxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAzKSB7XG4gICAgICAgICAgICAgIHNldExhc3RGdWxseUxvYWRlZFJlbGF0aW9uKHJlbGF0aW9ucy5pbmRleE9mKHJlbGF0aW9uKSlcbiAgICAgICAgICAgICAgZGlzcGF0Y2hPcHRpb25zKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnQUREJyxcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLFxuICAgICAgICAgICAgICAgIGNvbmZpZyxcbiAgICAgICAgICAgICAgICBkb2NzOiBbXSxcbiAgICAgICAgICAgICAgICBpMThuLFxuICAgICAgICAgICAgICAgIGlkczogcmVsYXRpb25NYXBbcmVsYXRpb25dLFxuICAgICAgICAgICAgICAgIHNvcnQsXG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzZXRFcnJvckxvYWRpbmcodCgnZXJyb3I6dW5zcGVjaWZpYycpKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSwgUHJvbWlzZS5yZXNvbHZlKCkpXG5cbiAgICAgICAgaWYgKHR5cGVvZiBvblN1Y2Nlc3MgPT09ICdmdW5jdGlvbicpIG9uU3VjY2VzcygpXG4gICAgICB9XG4gICAgfSxcbiAgICBbXG4gICAgICBwZXJtaXNzaW9ucyxcbiAgICAgIHJlbGF0aW9uVG8sXG4gICAgICBoYXNNYW55LFxuICAgICAgZXJyb3JMb2FkaW5nLFxuICAgICAgc2VhcmNoLFxuICAgICAgbGFzdExvYWRlZFBhZ2UsXG4gICAgICBjb2xsZWN0aW9ucyxcbiAgICAgIGxvY2FsZSxcbiAgICAgIGZpbHRlck9wdGlvbnNSZXN1bHQsXG4gICAgICBzZXJ2ZXJVUkwsXG4gICAgICBzb3J0T3B0aW9ucyxcbiAgICAgIGFwaSxcbiAgICAgIGkxOG4sXG4gICAgICBjb25maWcsXG4gICAgICB0LFxuICAgIF0sXG4gIClcblxuICBjb25zdCB1cGRhdGVTZWFyY2ggPSB1c2VEZWJvdW5jZWRDYWxsYmFjaygoc2VhcmNoQXJnOiBzdHJpbmcsIHZhbHVlQXJnOiBWYWx1ZSB8IFZhbHVlW10pID0+IHtcbiAgICBnZXRSZXN1bHRzKHsgc2VhcmNoOiBzZWFyY2hBcmcsIHNvcnQ6IHRydWUsIHZhbHVlOiB2YWx1ZUFyZyB9KVxuICAgIHNldFNlYXJjaChzZWFyY2hBcmcpXG4gIH0sIDMwMClcblxuICBjb25zdCBoYW5kbGVJbnB1dENoYW5nZSA9IHVzZUNhbGxiYWNrKFxuICAgIChzZWFyY2hBcmc6IHN0cmluZywgdmFsdWVBcmc6IFZhbHVlIHwgVmFsdWVbXSkgPT4ge1xuICAgICAgaWYgKHNlYXJjaCAhPT0gc2VhcmNoQXJnKSB7XG4gICAgICAgIHNldExhc3RMb2FkZWRQYWdlKHt9KVxuICAgICAgICB1cGRhdGVTZWFyY2goc2VhcmNoQXJnLCB2YWx1ZUFyZywgc2VhcmNoQXJnICE9PSAnJylcbiAgICAgIH1cbiAgICB9LFxuICAgIFtzZWFyY2gsIHVwZGF0ZVNlYXJjaF0sXG4gIClcblxuICAvLyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAvLyBFbnN1cmUgd2UgaGF2ZSBhbiBvcHRpb24gZm9yIGVhY2ggdmFsdWVcbiAgLy8gLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IHJlbGF0aW9uTWFwID0gY3JlYXRlUmVsYXRpb25NYXAoe1xuICAgICAgaGFzTWFueSxcbiAgICAgIHJlbGF0aW9uVG8sXG4gICAgICB2YWx1ZSxcbiAgICB9KVxuXG4gICAgT2JqZWN0LmVudHJpZXMocmVsYXRpb25NYXApLnJlZHVjZShhc3luYyAocHJpb3JSZWxhdGlvbiwgW3JlbGF0aW9uLCBpZHNdKSA9PiB7XG4gICAgICBhd2FpdCBwcmlvclJlbGF0aW9uXG5cbiAgICAgIGNvbnN0IGlkc1RvTG9hZCA9IGlkcy5maWx0ZXIoKGlkKSA9PiB7XG4gICAgICAgIHJldHVybiAhb3B0aW9ucy5maW5kKFxuICAgICAgICAgIChvcHRpb25Hcm91cCkgPT5cbiAgICAgICAgICAgIG9wdGlvbkdyb3VwPy5vcHRpb25zPy5maW5kKFxuICAgICAgICAgICAgICAob3B0aW9uKSA9PiBvcHRpb24udmFsdWUgPT09IGlkICYmIG9wdGlvbi5yZWxhdGlvblRvID09PSByZWxhdGlvbixcbiAgICAgICAgICAgICksXG4gICAgICAgIClcbiAgICAgIH0pXG5cbiAgICAgIGlmIChpZHNUb0xvYWQubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zdCBxdWVyeSA9IHtcbiAgICAgICAgICBkZXB0aDogMCxcbiAgICAgICAgICBkcmFmdDogdHJ1ZSxcbiAgICAgICAgICBsaW1pdDogaWRzVG9Mb2FkLmxlbmd0aCxcbiAgICAgICAgICBsb2NhbGUsXG4gICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgIGlkOiB7XG4gICAgICAgICAgICAgIGluOiBpZHNUb0xvYWQsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWVycm9yTG9hZGluZykge1xuICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7c2VydmVyVVJMfSR7YXBpfS8ke3JlbGF0aW9ufT8ke3FzLnN0cmluZ2lmeShxdWVyeSl9YCwge1xuICAgICAgICAgICAgY3JlZGVudGlhbHM6ICdpbmNsdWRlJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgJ0FjY2VwdC1MYW5ndWFnZSc6IGkxOG4ubGFuZ3VhZ2UsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0pXG5cbiAgICAgICAgICBjb25zdCBjb2xsZWN0aW9uID0gY29sbGVjdGlvbnMuZmluZCgoY29sbCkgPT4gY29sbC5zbHVnID09PSByZWxhdGlvbilcbiAgICAgICAgICBsZXQgZG9jcyA9IFtdXG5cbiAgICAgICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICAgICAgICAgIGRvY3MgPSBkYXRhLmRvY3NcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBkaXNwYXRjaE9wdGlvbnMoe1xuICAgICAgICAgICAgdHlwZTogJ0FERCcsXG4gICAgICAgICAgICBjb2xsZWN0aW9uLFxuICAgICAgICAgICAgY29uZmlnLFxuICAgICAgICAgICAgZG9jcyxcbiAgICAgICAgICAgIGkxOG4sXG4gICAgICAgICAgICBpZHM6IGlkc1RvTG9hZCxcbiAgICAgICAgICAgIHNvcnQ6IHRydWUsXG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIFByb21pc2UucmVzb2x2ZSgpKVxuICB9LCBbXG4gICAgb3B0aW9ucyxcbiAgICB2YWx1ZSxcbiAgICBoYXNNYW55LFxuICAgIGVycm9yTG9hZGluZyxcbiAgICBjb2xsZWN0aW9ucyxcbiAgICBoYXNNdWx0aXBsZVJlbGF0aW9ucyxcbiAgICBzZXJ2ZXJVUkwsXG4gICAgYXBpLFxuICAgIGkxOG4sXG4gICAgcmVsYXRpb25UbyxcbiAgICBsb2NhbGUsXG4gICAgY29uZmlnLFxuICBdKVxuXG4gIC8vIERldGVybWluZSBpZiB3ZSBzaG91bGQgc3dpdGNoIHRvIHdvcmQgYm91bmRhcnkgc2VhcmNoXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3QgcmVsYXRpb25zID0gQXJyYXkuaXNBcnJheShyZWxhdGlvblRvKSA/IHJlbGF0aW9uVG8gOiBbcmVsYXRpb25Ub11cbiAgICBjb25zdCBpc0lkT25seSA9IHJlbGF0aW9ucy5yZWR1Y2UoKGlkT25seSwgcmVsYXRpb24pID0+IHtcbiAgICAgIGNvbnN0IGNvbGxlY3Rpb24gPSBjb2xsZWN0aW9ucy5maW5kKChjb2xsKSA9PiBjb2xsLnNsdWcgPT09IHJlbGF0aW9uKVxuICAgICAgY29uc3QgZmllbGRUb1NlYXJjaCA9IGNvbGxlY3Rpb24/LmFkbWluPy51c2VBc1RpdGxlIHx8ICdpZCdcbiAgICAgIHJldHVybiBmaWVsZFRvU2VhcmNoID09PSAnaWQnICYmIGlkT25seVxuICAgIH0sIHRydWUpXG4gICAgc2V0RW5hYmxlV29yZEJvdW5kYXJ5U2VhcmNoKCFpc0lkT25seSlcbiAgfSwgW3JlbGF0aW9uVG8sIGNvbGxlY3Rpb25zXSlcblxuICAvLyBXaGVuIChgcmVsYXRpb25Ub2AgfHwgYGZpbHRlck9wdGlvbnNSZXN1bHRgIHx8IGBsb2NhbGVgKSBjaGFuZ2VzLCByZXNldCBjb21wb25lbnRcbiAgLy8gTm90ZSAtIGVmZmVjdCBzaG91bGQgbm90IHJ1biBvbiBmaXJzdCBydW5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoZmlyc3RSdW4uY3VycmVudCkge1xuICAgICAgZmlyc3RSdW4uY3VycmVudCA9IGZhbHNlXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBkaXNwYXRjaE9wdGlvbnMoeyB0eXBlOiAnQ0xFQVInIH0pXG4gICAgc2V0TGFzdEZ1bGx5TG9hZGVkUmVsYXRpb24oLTEpXG4gICAgc2V0TGFzdExvYWRlZFBhZ2Uoe30pXG4gICAgc2V0SGFzTG9hZGVkRmlyc3RQYWdlKGZhbHNlKVxuICB9LCBbcmVsYXRpb25UbywgZmlsdGVyT3B0aW9uc1Jlc3VsdCwgbG9jYWxlXSlcblxuICBjb25zdCBvblNhdmUgPSB1c2VDYWxsYmFjazxEb2N1bWVudERyYXdlclByb3BzWydvblNhdmUnXT4oXG4gICAgKGFyZ3MpID0+IHtcbiAgICAgIGRpc3BhdGNoT3B0aW9ucyh7XG4gICAgICAgIHR5cGU6ICdVUERBVEUnLFxuICAgICAgICBjb2xsZWN0aW9uOiBhcmdzLmNvbGxlY3Rpb25Db25maWcsXG4gICAgICAgIGNvbmZpZyxcbiAgICAgICAgZG9jOiBhcmdzLmRvYyxcbiAgICAgICAgaTE4bixcbiAgICAgIH0pXG4gICAgfSxcbiAgICBbaTE4biwgY29uZmlnXSxcbiAgKVxuXG4gIGNvbnN0IGZpbHRlck9wdGlvbiA9IHVzZUNhbGxiYWNrKChpdGVtOiBPcHRpb24sIHNlYXJjaEZpbHRlcjogc3RyaW5nKSA9PiB7XG4gICAgaWYgKCFzZWFyY2hGaWx0ZXIpIHtcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuICAgIGNvbnN0IHIgPSB3b3JkQm91bmRhcmllc1JlZ2V4KHNlYXJjaEZpbHRlciB8fCAnJylcbiAgICAvLyBicmVha2luZyB0aGUgbGFiZWxzIHRvIHNlYXJjaCBpbnRvIHNtYWxsZXIgcGFydHMgaW5jcmVhc2VzIHBlcmZvcm1hbmNlXG4gICAgY29uc3QgYnJlYWtBcGFydFRocmVzaG9sZCA9IDI1MFxuICAgIGxldCBzdHJpbmcgPSBpdGVtLmxhYmVsXG4gICAgLy8gc3RyaW5ncyBsZXNzIHRoYW4gYnJlYWtBcGFydFRocmVzaG9sZCBsZW5ndGggd29uJ3QgYmUgY2h1bmtlZFxuICAgIHdoaWxlIChzdHJpbmcubGVuZ3RoID4gYnJlYWtBcGFydFRocmVzaG9sZCkge1xuICAgICAgLy8gc2xpY2luZyBieSB0aGUgbmV4dCBzcGFjZSBhZnRlciB0aGUgbGVuZ3RoIG9mIHRoZSBzZWFyY2ggaW5wdXQgcHJldmVudHMgc2xpY2luZyB0aGUgc3RyaW5nIHVwIGJ5IHBhcnRpYWwgd29yZHNcbiAgICAgIGNvbnN0IGluZGV4T2ZTcGFjZSA9IHN0cmluZy5pbmRleE9mKCcgJywgc2VhcmNoRmlsdGVyLmxlbmd0aClcbiAgICAgIGlmIChyLnRlc3Qoc3RyaW5nLnNsaWNlKDAsIGluZGV4T2ZTcGFjZSA9PT0gLTEgPyBzZWFyY2hGaWx0ZXIubGVuZ3RoIDogaW5kZXhPZlNwYWNlICsgMSkpKSB7XG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgICB9XG4gICAgICBzdHJpbmcgPSBzdHJpbmcuc2xpY2UoaW5kZXhPZlNwYWNlID09PSAtMSA/IHNlYXJjaEZpbHRlci5sZW5ndGggOiBpbmRleE9mU3BhY2UgKyAxKVxuICAgIH1cbiAgICByZXR1cm4gci50ZXN0KHN0cmluZy5zbGljZSgtYnJlYWtBcGFydFRocmVzaG9sZCkpXG4gIH0sIFtdKVxuXG4gIGNvbnN0IHZhbHVlVG9SZW5kZXIgPSBmaW5kT3B0aW9uc0J5VmFsdWUoeyBvcHRpb25zLCB2YWx1ZSB9KVxuXG4gIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZVRvUmVuZGVyKSAmJiB2YWx1ZVRvUmVuZGVyPy52YWx1ZSA9PT0gJ251bGwnKSB2YWx1ZVRvUmVuZGVyLnZhbHVlID0gbnVsbFxuXG4gIHJldHVybiAoXG4gICAgPGRpdlxuICAgICAgY2xhc3NOYW1lPXtbXG4gICAgICAgIGZpZWxkQmFzZUNsYXNzLFxuICAgICAgICBiYXNlQ2xhc3MsXG4gICAgICAgIGNsYXNzTmFtZSxcbiAgICAgICAgc2hvd0Vycm9yICYmICdlcnJvcicsXG4gICAgICAgIGVycm9yTG9hZGluZyAmJiAnZXJyb3ItbG9hZGluZycsXG4gICAgICAgIHJlYWRPbmx5ICYmIGAke2Jhc2VDbGFzc30tLXJlYWQtb25seWAsXG4gICAgICBdXG4gICAgICAgIC5maWx0ZXIoQm9vbGVhbilcbiAgICAgICAgLmpvaW4oJyAnKX1cbiAgICAgIGlkPXtgZmllbGQtJHtwYXRoT3JOYW1lLnJlcGxhY2UoL1xcLi9nLCAnX18nKX1gfVxuICAgICAgc3R5bGU9e3tcbiAgICAgICAgLi4uc3R5bGUsXG4gICAgICAgIHdpZHRoLFxuICAgICAgfX1cbiAgICA+XG4gICAgICA8RXJyb3JDb21wIG1lc3NhZ2U9e2Vycm9yTWVzc2FnZX0gc2hvd0Vycm9yPXtzaG93RXJyb3J9IC8+XG4gICAgICA8TGFiZWxDb21wIGh0bWxGb3I9e3BhdGhPck5hbWV9IGxhYmVsPXtsYWJlbH0gcmVxdWlyZWQ9e3JlcXVpcmVkfSAvPlxuICAgICAgPEdldEZpbHRlck9wdGlvbnNcbiAgICAgICAgey4uLntcbiAgICAgICAgICBmaWx0ZXJPcHRpb25zLFxuICAgICAgICAgIGZpbHRlck9wdGlvbnNSZXN1bHQsXG4gICAgICAgICAgcGF0aDogcGF0aE9yTmFtZSxcbiAgICAgICAgICByZWxhdGlvblRvLFxuICAgICAgICAgIHNldEZpbHRlck9wdGlvbnNSZXN1bHQsXG4gICAgICAgIH19XG4gICAgICAvPlxuICAgICAgeyFlcnJvckxvYWRpbmcgJiYgKFxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YCR7YmFzZUNsYXNzfV9fd3JhcGB9PlxuICAgICAgICAgIDxSZWFjdFNlbGVjdFxuICAgICAgICAgICAgYmFja3NwYWNlUmVtb3Zlc1ZhbHVlPXshZHJhd2VySXNPcGVufVxuICAgICAgICAgICAgY29tcG9uZW50cz17e1xuICAgICAgICAgICAgICBNdWx0aVZhbHVlTGFiZWwsXG4gICAgICAgICAgICAgIFNpbmdsZVZhbHVlLFxuICAgICAgICAgICAgfX1cbiAgICAgICAgICAgIGN1c3RvbVByb3BzPXt7XG4gICAgICAgICAgICAgIGRpc2FibGVLZXlEb3duOiBkcmF3ZXJJc09wZW4sXG4gICAgICAgICAgICAgIGRpc2FibGVNb3VzZURvd246IGRyYXdlcklzT3BlbixcbiAgICAgICAgICAgICAgb25TYXZlLFxuICAgICAgICAgICAgICBzZXREcmF3ZXJJc09wZW4sXG4gICAgICAgICAgICB9fVxuICAgICAgICAgICAgZGlzYWJsZWQ9e3JlYWRPbmx5IHx8IGZvcm1Qcm9jZXNzaW5nfVxuICAgICAgICAgICAgZmlsdGVyT3B0aW9uPXtlbmFibGVXb3JkQm91bmRhcnlTZWFyY2ggPyBmaWx0ZXJPcHRpb24gOiB1bmRlZmluZWR9XG4gICAgICAgICAgICBpc0xvYWRpbmc9e2lzTG9hZGluZ31cbiAgICAgICAgICAgIGlzTXVsdGk9e2hhc01hbnl9XG4gICAgICAgICAgICBpc1NvcnRhYmxlPXtpc1NvcnRhYmxlfVxuICAgICAgICAgICAgb25DaGFuZ2U9e1xuICAgICAgICAgICAgICAhcmVhZE9ubHlcbiAgICAgICAgICAgICAgICA/IChzZWxlY3RlZCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICBzZXRWYWx1ZShoYXNNYW55ID8gW10gOiBudWxsKVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGhhc01hbnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICBzZXRWYWx1ZShcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgID8gc2VsZWN0ZWQubWFwKChvcHRpb24pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYXNNdWx0aXBsZVJlbGF0aW9ucykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0aW9uVG86IG9wdGlvbi5yZWxhdGlvblRvLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBvcHRpb24udmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbi52YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaGFzTXVsdGlwbGVSZWxhdGlvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICBzZXRWYWx1ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWxhdGlvblRvOiBzZWxlY3RlZC5yZWxhdGlvblRvLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHNlbGVjdGVkLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgc2V0VmFsdWUoc2VsZWN0ZWQudmFsdWUpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb25JbnB1dENoYW5nZT17KG5ld1NlYXJjaCkgPT4gaGFuZGxlSW5wdXRDaGFuZ2UobmV3U2VhcmNoLCB2YWx1ZSl9XG4gICAgICAgICAgICBvbk1lbnVPcGVuPXsoKSA9PiB7XG4gICAgICAgICAgICAgIGlmICghaGFzTG9hZGVkRmlyc3RQYWdlKSB7XG4gICAgICAgICAgICAgICAgc2V0SXNMb2FkaW5nKHRydWUpXG4gICAgICAgICAgICAgICAgZ2V0UmVzdWx0cyh7XG4gICAgICAgICAgICAgICAgICBvblN1Y2Nlc3M6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgc2V0SGFzTG9hZGVkRmlyc3RQYWdlKHRydWUpXG4gICAgICAgICAgICAgICAgICAgIHNldElzTG9hZGluZyhmYWxzZSlcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICB2YWx1ZTogaW5pdGlhbFZhbHVlLFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH19XG4gICAgICAgICAgICBvbk1lbnVTY3JvbGxUb0JvdHRvbT17KCkgPT4ge1xuICAgICAgICAgICAgICBnZXRSZXN1bHRzKHtcbiAgICAgICAgICAgICAgICBsYXN0RnVsbHlMb2FkZWRSZWxhdGlvbixcbiAgICAgICAgICAgICAgICBzZWFyY2gsXG4gICAgICAgICAgICAgICAgc29ydDogZmFsc2UsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGluaXRpYWxWYWx1ZSxcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH19XG4gICAgICAgICAgICBvcHRpb25zPXtvcHRpb25zfVxuICAgICAgICAgICAgc2hvd0Vycm9yPXtzaG93RXJyb3J9XG4gICAgICAgICAgICB2YWx1ZT17dmFsdWVUb1JlbmRlciA/PyBudWxsfVxuICAgICAgICAgIC8+XG4gICAgICAgICAgeyFyZWFkT25seSAmJiBhbGxvd0NyZWF0ZSAmJiAoXG4gICAgICAgICAgICA8QWRkTmV3UmVsYXRpb25cbiAgICAgICAgICAgICAgey4uLntcbiAgICAgICAgICAgICAgICBkaXNwYXRjaE9wdGlvbnMsXG4gICAgICAgICAgICAgICAgaGFzTWFueSxcbiAgICAgICAgICAgICAgICBvcHRpb25zLFxuICAgICAgICAgICAgICAgIHBhdGg6IHBhdGhPck5hbWUsXG4gICAgICAgICAgICAgICAgcmVsYXRpb25UbyxcbiAgICAgICAgICAgICAgICBzZXRWYWx1ZSxcbiAgICAgICAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgKX1cbiAgICAgICAgPC9kaXY+XG4gICAgICApfVxuICAgICAge2Vycm9yTG9hZGluZyAmJiA8ZGl2IGNsYXNzTmFtZT17YCR7YmFzZUNsYXNzfV9fZXJyb3ItbG9hZGluZ2B9PntlcnJvckxvYWRpbmd9PC9kaXY+fVxuICAgICAgPEZpZWxkRGVzY3JpcHRpb24gZGVzY3JpcHRpb249e2Rlc2NyaXB0aW9ufSBwYXRoPXtwYXRofSB2YWx1ZT17dmFsdWV9IC8+XG4gICAgPC9kaXY+XG4gIClcbn1cblxuZXhwb3J0IGRlZmF1bHQgd2l0aENvbmRpdGlvbihSZWxhdGlvbnNoaXApXG4iXSwibmFtZXMiOlsibWF4UmVzdWx0c1BlclJlcXVlc3QiLCJiYXNlQ2xhc3MiLCJSZWxhdGlvbnNoaXAiLCJwcm9wcyIsIm5hbWUiLCJhZG1pbiIsImFsbG93Q3JlYXRlIiwiY2xhc3NOYW1lIiwiY29tcG9uZW50cyIsIkVycm9yIiwiTGFiZWwiLCJjb25kaXRpb24iLCJkZXNjcmlwdGlvbiIsImlzU29ydGFibGUiLCJyZWFkT25seSIsInNvcnRPcHRpb25zIiwic3R5bGUiLCJ3aWR0aCIsImZpbHRlck9wdGlvbnMiLCJoYXNNYW55IiwibGFiZWwiLCJwYXRoIiwicmVsYXRpb25UbyIsInJlcXVpcmVkIiwidmFsaWRhdGUiLCJyZWxhdGlvbnNoaXAiLCJFcnJvckNvbXAiLCJEZWZhdWx0RXJyb3IiLCJMYWJlbENvbXAiLCJEZWZhdWx0TGFiZWwiLCJjb25maWciLCJ1c2VDb25maWciLCJjb2xsZWN0aW9ucyIsInJvdXRlcyIsImFwaSIsInNlcnZlclVSTCIsImkxOG4iLCJ0IiwidXNlVHJhbnNsYXRpb24iLCJwZXJtaXNzaW9ucyIsInVzZUF1dGgiLCJjb2RlIiwibG9jYWxlIiwidXNlTG9jYWxlIiwiZm9ybVByb2Nlc3NpbmciLCJ1c2VGb3JtUHJvY2Vzc2luZyIsImhhc011bHRpcGxlUmVsYXRpb25zIiwiQXJyYXkiLCJpc0FycmF5Iiwib3B0aW9ucyIsImRpc3BhdGNoT3B0aW9ucyIsInVzZVJlZHVjZXIiLCJvcHRpb25zUmVkdWNlciIsImxhc3RGdWxseUxvYWRlZFJlbGF0aW9uIiwic2V0TGFzdEZ1bGx5TG9hZGVkUmVsYXRpb24iLCJ1c2VTdGF0ZSIsImxhc3RMb2FkZWRQYWdlIiwic2V0TGFzdExvYWRlZFBhZ2UiLCJlcnJvckxvYWRpbmciLCJzZXRFcnJvckxvYWRpbmciLCJmaWx0ZXJPcHRpb25zUmVzdWx0Iiwic2V0RmlsdGVyT3B0aW9uc1Jlc3VsdCIsInNlYXJjaCIsInNldFNlYXJjaCIsImlzTG9hZGluZyIsInNldElzTG9hZGluZyIsImhhc0xvYWRlZEZpcnN0UGFnZSIsInNldEhhc0xvYWRlZEZpcnN0UGFnZSIsImVuYWJsZVdvcmRCb3VuZGFyeVNlYXJjaCIsInNldEVuYWJsZVdvcmRCb3VuZGFyeVNlYXJjaCIsImZpcnN0UnVuIiwidXNlUmVmIiwicGF0aE9yTmFtZSIsIm1lbW9pemVkVmFsaWRhdGUiLCJ1c2VDYWxsYmFjayIsInZhbHVlIiwidmFsaWRhdGlvbk9wdGlvbnMiLCJlcnJvck1lc3NhZ2UiLCJpbml0aWFsVmFsdWUiLCJzZXRWYWx1ZSIsInNob3dFcnJvciIsInVzZUZpZWxkIiwiZHJhd2VySXNPcGVuIiwic2V0RHJhd2VySXNPcGVuIiwiZ2V0UmVzdWx0cyIsImxhc3RGdWxseUxvYWRlZFJlbGF0aW9uQXJnIiwib25TdWNjZXNzIiwic2VhcmNoQXJnIiwic29ydCIsInZhbHVlQXJnIiwibGFzdEZ1bGx5TG9hZGVkUmVsYXRpb25Ub1VzZSIsInJlbGF0aW9ucyIsInJlbGF0aW9uc1RvRmV0Y2giLCJzbGljZSIsInJlc3VsdHNGZXRjaGVkIiwicmVsYXRpb25NYXAiLCJjcmVhdGVSZWxhdGlvbk1hcCIsInJlZHVjZSIsInByaW9yUmVsYXRpb24iLCJyZWxhdGlvbiIsInJlbGF0aW9uRmlsdGVyT3B0aW9uIiwibGFzdExvYWRlZFBhZ2VUb1VzZSIsImluZGV4T2YiLCJQcm9taXNlIiwicmVzb2x2ZSIsImNvbGxlY3Rpb24iLCJmaW5kIiwiY29sbCIsInNsdWciLCJmaWVsZFRvU2VhcmNoIiwiZGVmYXVsdFNvcnQiLCJ1c2VBc1RpdGxlIiwicXVlcnkiLCJkZXB0aCIsImRyYWZ0IiwibGltaXQiLCJwYWdlIiwid2hlcmUiLCJhbmQiLCJpZCIsIm5vdF9pbiIsInB1c2giLCJsaWtlIiwicmVzcG9uc2UiLCJmZXRjaCIsInFzIiwic3RyaW5naWZ5IiwiY3JlZGVudGlhbHMiLCJoZWFkZXJzIiwibGFuZ3VhZ2UiLCJvayIsImRhdGEiLCJqc29uIiwicHJldlN0YXRlIiwibmV4dFBhZ2UiLCJkb2NzIiwibGVuZ3RoIiwidHlwZSIsInN0YXR1cyIsImlkcyIsInVwZGF0ZVNlYXJjaCIsInVzZURlYm91bmNlZENhbGxiYWNrIiwiaGFuZGxlSW5wdXRDaGFuZ2UiLCJ1c2VFZmZlY3QiLCJPYmplY3QiLCJlbnRyaWVzIiwiaWRzVG9Mb2FkIiwiZmlsdGVyIiwib3B0aW9uR3JvdXAiLCJvcHRpb24iLCJpbiIsImlzSWRPbmx5IiwiaWRPbmx5IiwiY3VycmVudCIsIm9uU2F2ZSIsImFyZ3MiLCJjb2xsZWN0aW9uQ29uZmlnIiwiZG9jIiwiZmlsdGVyT3B0aW9uIiwiaXRlbSIsInNlYXJjaEZpbHRlciIsInIiLCJ3b3JkQm91bmRhcmllc1JlZ2V4IiwiYnJlYWtBcGFydFRocmVzaG9sZCIsInN0cmluZyIsImluZGV4T2ZTcGFjZSIsInRlc3QiLCJ2YWx1ZVRvUmVuZGVyIiwiZmluZE9wdGlvbnNCeVZhbHVlIiwiZGl2IiwiZmllbGRCYXNlQ2xhc3MiLCJCb29sZWFuIiwiam9pbiIsInJlcGxhY2UiLCJtZXNzYWdlIiwiaHRtbEZvciIsIkdldEZpbHRlck9wdGlvbnMiLCJSZWFjdFNlbGVjdCIsImJhY2tzcGFjZVJlbW92ZXNWYWx1ZSIsIk11bHRpVmFsdWVMYWJlbCIsIlNpbmdsZVZhbHVlIiwiY3VzdG9tUHJvcHMiLCJkaXNhYmxlS2V5RG93biIsImRpc2FibGVNb3VzZURvd24iLCJkaXNhYmxlZCIsInVuZGVmaW5lZCIsImlzTXVsdGkiLCJvbkNoYW5nZSIsInNlbGVjdGVkIiwibWFwIiwib25JbnB1dENoYW5nZSIsIm5ld1NlYXJjaCIsIm9uTWVudU9wZW4iLCJvbk1lbnVTY3JvbGxUb0JvdHRvbSIsIkFkZE5ld1JlbGF0aW9uIiwiRmllbGREZXNjcmlwdGlvbiIsIndpdGhDb25kaXRpb24iXSwibWFw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