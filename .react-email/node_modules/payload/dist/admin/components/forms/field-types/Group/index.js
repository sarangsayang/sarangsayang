"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return _default;
    }
});
const _react = /*#__PURE__*/ _interop_require_default(require("react"));
const _reacti18next = require("react-i18next");
const _getTranslation = require("../../../../../utilities/getTranslation");
const _provider = require("../../../elements/Collapsible/provider");
const _ErrorPill = require("../../../elements/ErrorPill");
const _FieldDescription = /*#__PURE__*/ _interop_require_default(require("../../FieldDescription"));
const _context = require("../../Form/context");
const _createNestedFieldPath = require("../../Form/createNestedFieldPath");
const _RenderFields = /*#__PURE__*/ _interop_require_default(require("../../RenderFields"));
const _WatchChildErrors = require("../../WatchChildErrors");
const _withCondition = /*#__PURE__*/ _interop_require_default(require("../../withCondition"));
const _provider1 = require("../Row/provider");
const _provider2 = require("../Tabs/provider");
const _shared = require("../shared");
require("./index.scss");
const _provider3 = require("./provider");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
const baseClass = 'group-field';
const Group = (props)=>{
    const { name, admin: { className, description, hideGutter = false, readOnly, style, width }, fieldTypes, fields, forceRender = false, indexPath, label, path: pathFromProps, permissions } = props;
    const isWithinCollapsible = (0, _provider.useCollapsible)();
    const isWithinGroup = (0, _provider3.useGroup)();
    const isWithinRow = (0, _provider1.useRow)();
    const isWithinTab = (0, _provider2.useTabs)();
    const { i18n } = (0, _reacti18next.useTranslation)();
    const submitted = (0, _context.useFormSubmitted)();
    const [errorCount, setErrorCount] = _react.default.useState(undefined);
    const groupHasErrors = submitted && errorCount > 0;
    const path = pathFromProps || name;
    const isTopLevel = !(isWithinCollapsible || isWithinGroup || isWithinRow);
    return /*#__PURE__*/ _react.default.createElement("div", {
        className: [
            _shared.fieldBaseClass,
            baseClass,
            isTopLevel && `${baseClass}--top-level`,
            isWithinCollapsible && `${baseClass}--within-collapsible`,
            isWithinGroup && `${baseClass}--within-group`,
            isWithinRow && `${baseClass}--within-row`,
            isWithinTab && `${baseClass}--within-tab`,
            !hideGutter && isWithinGroup && `${baseClass}--gutter`,
            groupHasErrors && `${baseClass}--has-error`,
            className
        ].filter(Boolean).join(' '),
        id: `field-${path.replace(/\./g, '__')}`,
        style: {
            ...style,
            width
        }
    }, /*#__PURE__*/ _react.default.createElement(_WatchChildErrors.WatchChildErrors, {
        fieldSchema: fields,
        path: path,
        setErrorCount: setErrorCount
    }), /*#__PURE__*/ _react.default.createElement(_provider3.GroupProvider, null, /*#__PURE__*/ _react.default.createElement("div", {
        className: `${baseClass}__wrap`
    }, /*#__PURE__*/ _react.default.createElement("div", {
        className: `${baseClass}__header`
    }, (label || description) && /*#__PURE__*/ _react.default.createElement("header", null, label && /*#__PURE__*/ _react.default.createElement("h3", {
        className: `${baseClass}__title`
    }, (0, _getTranslation.getTranslation)(label, i18n)), /*#__PURE__*/ _react.default.createElement(_FieldDescription.default, {
        className: `field-description-${path.replace(/\./g, '__')}`,
        description: description,
        path: path,
        value: null
    })), groupHasErrors && /*#__PURE__*/ _react.default.createElement(_ErrorPill.ErrorPill, {
        count: errorCount,
        withMessage: true
    })), /*#__PURE__*/ _react.default.createElement(_RenderFields.default, {
        fieldSchema: fields.map((subField)=>({
                ...subField,
                path: (0, _createNestedFieldPath.createNestedFieldPath)(path, subField)
            })),
        fieldTypes: fieldTypes,
        forceRender: forceRender,
        indexPath: indexPath,
        margins: "small",
        permissions: permissions?.fields,
        readOnly: readOnly
    }))));
};
const _default = (0, _withCondition.default)(Group);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9hZG1pbi9jb21wb25lbnRzL2Zvcm1zL2ZpZWxkLXR5cGVzL0dyb3VwL2luZGV4LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnXG5pbXBvcnQgeyB1c2VUcmFuc2xhdGlvbiB9IGZyb20gJ3JlYWN0LWkxOG5leHQnXG5cbmltcG9ydCB0eXBlIHsgUHJvcHMgfSBmcm9tICcuL3R5cGVzJ1xuXG5pbXBvcnQgeyBnZXRUcmFuc2xhdGlvbiB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL3V0aWxpdGllcy9nZXRUcmFuc2xhdGlvbidcbmltcG9ydCB7IHVzZUNvbGxhcHNpYmxlIH0gZnJvbSAnLi4vLi4vLi4vZWxlbWVudHMvQ29sbGFwc2libGUvcHJvdmlkZXInXG5pbXBvcnQgeyBFcnJvclBpbGwgfSBmcm9tICcuLi8uLi8uLi9lbGVtZW50cy9FcnJvclBpbGwnXG5pbXBvcnQgRmllbGREZXNjcmlwdGlvbiBmcm9tICcuLi8uLi9GaWVsZERlc2NyaXB0aW9uJ1xuaW1wb3J0IHsgdXNlRm9ybVN1Ym1pdHRlZCB9IGZyb20gJy4uLy4uL0Zvcm0vY29udGV4dCdcbmltcG9ydCB7IGNyZWF0ZU5lc3RlZEZpZWxkUGF0aCB9IGZyb20gJy4uLy4uL0Zvcm0vY3JlYXRlTmVzdGVkRmllbGRQYXRoJ1xuaW1wb3J0IFJlbmRlckZpZWxkcyBmcm9tICcuLi8uLi9SZW5kZXJGaWVsZHMnXG5pbXBvcnQgeyBXYXRjaENoaWxkRXJyb3JzIH0gZnJvbSAnLi4vLi4vV2F0Y2hDaGlsZEVycm9ycydcbmltcG9ydCB3aXRoQ29uZGl0aW9uIGZyb20gJy4uLy4uL3dpdGhDb25kaXRpb24nXG5pbXBvcnQgeyB1c2VSb3cgfSBmcm9tICcuLi9Sb3cvcHJvdmlkZXInXG5pbXBvcnQgeyB1c2VUYWJzIH0gZnJvbSAnLi4vVGFicy9wcm92aWRlcidcbmltcG9ydCB7IGZpZWxkQmFzZUNsYXNzIH0gZnJvbSAnLi4vc2hhcmVkJ1xuaW1wb3J0ICcuL2luZGV4LnNjc3MnXG5pbXBvcnQgeyBHcm91cFByb3ZpZGVyLCB1c2VHcm91cCB9IGZyb20gJy4vcHJvdmlkZXInXG5cbmNvbnN0IGJhc2VDbGFzcyA9ICdncm91cC1maWVsZCdcblxuY29uc3QgR3JvdXA6IFJlYWN0LkZDPFByb3BzPiA9IChwcm9wcykgPT4ge1xuICBjb25zdCB7XG4gICAgbmFtZSxcbiAgICBhZG1pbjogeyBjbGFzc05hbWUsIGRlc2NyaXB0aW9uLCBoaWRlR3V0dGVyID0gZmFsc2UsIHJlYWRPbmx5LCBzdHlsZSwgd2lkdGggfSxcbiAgICBmaWVsZFR5cGVzLFxuICAgIGZpZWxkcyxcbiAgICBmb3JjZVJlbmRlciA9IGZhbHNlLFxuICAgIGluZGV4UGF0aCxcbiAgICBsYWJlbCxcbiAgICBwYXRoOiBwYXRoRnJvbVByb3BzLFxuICAgIHBlcm1pc3Npb25zLFxuICB9ID0gcHJvcHNcblxuICBjb25zdCBpc1dpdGhpbkNvbGxhcHNpYmxlID0gdXNlQ29sbGFwc2libGUoKVxuICBjb25zdCBpc1dpdGhpbkdyb3VwID0gdXNlR3JvdXAoKVxuICBjb25zdCBpc1dpdGhpblJvdyA9IHVzZVJvdygpXG4gIGNvbnN0IGlzV2l0aGluVGFiID0gdXNlVGFicygpXG4gIGNvbnN0IHsgaTE4biB9ID0gdXNlVHJhbnNsYXRpb24oKVxuICBjb25zdCBzdWJtaXR0ZWQgPSB1c2VGb3JtU3VibWl0dGVkKClcbiAgY29uc3QgW2Vycm9yQ291bnQsIHNldEVycm9yQ291bnRdID0gUmVhY3QudXNlU3RhdGUodW5kZWZpbmVkKVxuICBjb25zdCBncm91cEhhc0Vycm9ycyA9IHN1Ym1pdHRlZCAmJiBlcnJvckNvdW50ID4gMFxuXG4gIGNvbnN0IHBhdGggPSBwYXRoRnJvbVByb3BzIHx8IG5hbWVcbiAgY29uc3QgaXNUb3BMZXZlbCA9ICEoaXNXaXRoaW5Db2xsYXBzaWJsZSB8fCBpc1dpdGhpbkdyb3VwIHx8IGlzV2l0aGluUm93KVxuXG4gIHJldHVybiAoXG4gICAgPGRpdlxuICAgICAgY2xhc3NOYW1lPXtbXG4gICAgICAgIGZpZWxkQmFzZUNsYXNzLFxuICAgICAgICBiYXNlQ2xhc3MsXG4gICAgICAgIGlzVG9wTGV2ZWwgJiYgYCR7YmFzZUNsYXNzfS0tdG9wLWxldmVsYCxcbiAgICAgICAgaXNXaXRoaW5Db2xsYXBzaWJsZSAmJiBgJHtiYXNlQ2xhc3N9LS13aXRoaW4tY29sbGFwc2libGVgLFxuICAgICAgICBpc1dpdGhpbkdyb3VwICYmIGAke2Jhc2VDbGFzc30tLXdpdGhpbi1ncm91cGAsXG4gICAgICAgIGlzV2l0aGluUm93ICYmIGAke2Jhc2VDbGFzc30tLXdpdGhpbi1yb3dgLFxuICAgICAgICBpc1dpdGhpblRhYiAmJiBgJHtiYXNlQ2xhc3N9LS13aXRoaW4tdGFiYCxcbiAgICAgICAgIWhpZGVHdXR0ZXIgJiYgaXNXaXRoaW5Hcm91cCAmJiBgJHtiYXNlQ2xhc3N9LS1ndXR0ZXJgLFxuICAgICAgICBncm91cEhhc0Vycm9ycyAmJiBgJHtiYXNlQ2xhc3N9LS1oYXMtZXJyb3JgLFxuICAgICAgICBjbGFzc05hbWUsXG4gICAgICBdXG4gICAgICAgIC5maWx0ZXIoQm9vbGVhbilcbiAgICAgICAgLmpvaW4oJyAnKX1cbiAgICAgIGlkPXtgZmllbGQtJHtwYXRoLnJlcGxhY2UoL1xcLi9nLCAnX18nKX1gfVxuICAgICAgc3R5bGU9e3tcbiAgICAgICAgLi4uc3R5bGUsXG4gICAgICAgIHdpZHRoLFxuICAgICAgfX1cbiAgICA+XG4gICAgICA8V2F0Y2hDaGlsZEVycm9ycyBmaWVsZFNjaGVtYT17ZmllbGRzfSBwYXRoPXtwYXRofSBzZXRFcnJvckNvdW50PXtzZXRFcnJvckNvdW50fSAvPlxuICAgICAgPEdyb3VwUHJvdmlkZXI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPXtgJHtiYXNlQ2xhc3N9X193cmFwYH0+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2Ake2Jhc2VDbGFzc31fX2hlYWRlcmB9PlxuICAgICAgICAgICAgeyhsYWJlbCB8fCBkZXNjcmlwdGlvbikgJiYgKFxuICAgICAgICAgICAgICA8aGVhZGVyPlxuICAgICAgICAgICAgICAgIHtsYWJlbCAmJiA8aDMgY2xhc3NOYW1lPXtgJHtiYXNlQ2xhc3N9X190aXRsZWB9PntnZXRUcmFuc2xhdGlvbihsYWJlbCwgaTE4bil9PC9oMz59XG4gICAgICAgICAgICAgICAgPEZpZWxkRGVzY3JpcHRpb25cbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17YGZpZWxkLWRlc2NyaXB0aW9uLSR7cGF0aC5yZXBsYWNlKC9cXC4vZywgJ19fJyl9YH1cbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uPXtkZXNjcmlwdGlvbn1cbiAgICAgICAgICAgICAgICAgIHBhdGg9e3BhdGh9XG4gICAgICAgICAgICAgICAgICB2YWx1ZT17bnVsbH1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8L2hlYWRlcj5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICB7Z3JvdXBIYXNFcnJvcnMgJiYgPEVycm9yUGlsbCBjb3VudD17ZXJyb3JDb3VudH0gd2l0aE1lc3NhZ2UgLz59XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPFJlbmRlckZpZWxkc1xuICAgICAgICAgICAgZmllbGRTY2hlbWE9e2ZpZWxkcy5tYXAoKHN1YkZpZWxkKSA9PiAoe1xuICAgICAgICAgICAgICAuLi5zdWJGaWVsZCxcbiAgICAgICAgICAgICAgcGF0aDogY3JlYXRlTmVzdGVkRmllbGRQYXRoKHBhdGgsIHN1YkZpZWxkKSxcbiAgICAgICAgICAgIH0pKX1cbiAgICAgICAgICAgIGZpZWxkVHlwZXM9e2ZpZWxkVHlwZXN9XG4gICAgICAgICAgICBmb3JjZVJlbmRlcj17Zm9yY2VSZW5kZXJ9XG4gICAgICAgICAgICBpbmRleFBhdGg9e2luZGV4UGF0aH1cbiAgICAgICAgICAgIG1hcmdpbnM9XCJzbWFsbFwiXG4gICAgICAgICAgICBwZXJtaXNzaW9ucz17cGVybWlzc2lvbnM/LmZpZWxkc31cbiAgICAgICAgICAgIHJlYWRPbmx5PXtyZWFkT25seX1cbiAgICAgICAgICAvPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvR3JvdXBQcm92aWRlcj5cbiAgICA8L2Rpdj5cbiAgKVxufVxuXG5leHBvcnQgZGVmYXVsdCB3aXRoQ29uZGl0aW9uKEdyb3VwKVxuIl0sIm5hbWVzIjpbImJhc2VDbGFzcyIsIkdyb3VwIiwicHJvcHMiLCJuYW1lIiwiYWRtaW4iLCJjbGFzc05hbWUiLCJkZXNjcmlwdGlvbiIsImhpZGVHdXR0ZXIiLCJyZWFkT25seSIsInN0eWxlIiwid2lkdGgiLCJmaWVsZFR5cGVzIiwiZmllbGRzIiwiZm9yY2VSZW5kZXIiLCJpbmRleFBhdGgiLCJsYWJlbCIsInBhdGgiLCJwYXRoRnJvbVByb3BzIiwicGVybWlzc2lvbnMiLCJpc1dpdGhpbkNvbGxhcHNpYmxlIiwidXNlQ29sbGFwc2libGUiLCJpc1dpdGhpbkdyb3VwIiwidXNlR3JvdXAiLCJpc1dpdGhpblJvdyIsInVzZVJvdyIsImlzV2l0aGluVGFiIiwidXNlVGFicyIsImkxOG4iLCJ1c2VUcmFuc2xhdGlvbiIsInN1Ym1pdHRlZCIsInVzZUZvcm1TdWJtaXR0ZWQiLCJlcnJvckNvdW50Iiwic2V0RXJyb3JDb3VudCIsIlJlYWN0IiwidXNlU3RhdGUiLCJ1bmRlZmluZWQiLCJncm91cEhhc0Vycm9ycyIsImlzVG9wTGV2ZWwiLCJkaXYiLCJmaWVsZEJhc2VDbGFzcyIsImZpbHRlciIsIkJvb2xlYW4iLCJqb2luIiwiaWQiLCJyZXBsYWNlIiwiV2F0Y2hDaGlsZEVycm9ycyIsImZpZWxkU2NoZW1hIiwiR3JvdXBQcm92aWRlciIsImhlYWRlciIsImgzIiwiZ2V0VHJhbnNsYXRpb24iLCJGaWVsZERlc2NyaXB0aW9uIiwidmFsdWUiLCJFcnJvclBpbGwiLCJjb3VudCIsIndpdGhNZXNzYWdlIiwiUmVuZGVyRmllbGRzIiwibWFwIiwic3ViRmllbGQiLCJjcmVhdGVOZXN0ZWRGaWVsZFBhdGgiLCJtYXJnaW5zIiwid2l0aENvbmRpdGlvbiJd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