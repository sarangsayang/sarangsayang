"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return _default;
    }
});
const _errors = require("../../../errors");
const _setRequestContext = require("../../../express/setRequestContext");
const _init = require("../../../translations/init");
const _dataloader = require("../../dataloader");
const _delete = /*#__PURE__*/ _interop_require_default(require("../delete"));
const _deleteByID = /*#__PURE__*/ _interop_require_default(require("../deleteByID"));
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
async function deleteLocal(payload, options) {
    const { id, collection: collectionSlug, context, depth, fallbackLocale: fallbackLocaleArg = options?.req?.fallbackLocale, locale: localeArg = null, overrideAccess = true, req: incomingReq = {}, showHiddenFields, user, where } = options;
    const collection = payload.collections[collectionSlug];
    const localizationConfig = payload?.config?.localization;
    const defaultLocale = localizationConfig ? localizationConfig.defaultLocale : null;
    const locale = localeArg || incomingReq?.locale || defaultLocale;
    const fallbackLocale = localizationConfig ? localizationConfig.locales.find(({ code })=>locale === code)?.fallbackLocale : null;
    if (!collection) {
        throw new _errors.APIError(`The collection with slug ${String(collectionSlug)} can't be found. Delete Operation.`);
    }
    const req = {
        fallbackLocale: typeof fallbackLocaleArg !== 'undefined' ? fallbackLocaleArg : fallbackLocale || defaultLocale,
        i18n: (0, _init.i18nInit)(payload.config.i18n),
        locale: locale,
        payload,
        payloadAPI: 'local',
        transactionID: incomingReq?.transactionID,
        user
    };
    (0, _setRequestContext.setRequestContext)(req, context);
    if (!req.t) req.t = req.i18n.t;
    if (!req.payloadDataLoader) req.payloadDataLoader = (0, _dataloader.getDataLoader)(req);
    const args = {
        id,
        collection,
        depth,
        overrideAccess,
        req,
        showHiddenFields,
        where
    };
    if (options.id) {
        return (0, _deleteByID.default)(args);
    }
    return (0, _delete.default)(args);
}
const _default = deleteLocal;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb2xsZWN0aW9ucy9vcGVyYXRpb25zL2xvY2FsL2RlbGV0ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEdlbmVyYXRlZFR5cGVzIH0gZnJvbSAnLi4vLi4vLi4vJ1xuaW1wb3J0IHR5cGUgeyBQYXlsb2FkUmVxdWVzdCwgUmVxdWVzdENvbnRleHQgfSBmcm9tICcuLi8uLi8uLi9leHByZXNzL3R5cGVzJ1xuaW1wb3J0IHR5cGUgeyBQYXlsb2FkIH0gZnJvbSAnLi4vLi4vLi4vcGF5bG9hZCdcbmltcG9ydCB0eXBlIHsgRG9jdW1lbnQsIFdoZXJlIH0gZnJvbSAnLi4vLi4vLi4vdHlwZXMnXG5pbXBvcnQgdHlwZSB7IEJ1bGtPcGVyYXRpb25SZXN1bHQgfSBmcm9tICcuLi8uLi9jb25maWcvdHlwZXMnXG5cbmltcG9ydCB7IEFQSUVycm9yIH0gZnJvbSAnLi4vLi4vLi4vZXJyb3JzJ1xuaW1wb3J0IHsgc2V0UmVxdWVzdENvbnRleHQgfSBmcm9tICcuLi8uLi8uLi9leHByZXNzL3NldFJlcXVlc3RDb250ZXh0J1xuaW1wb3J0IHsgaTE4bkluaXQgfSBmcm9tICcuLi8uLi8uLi90cmFuc2xhdGlvbnMvaW5pdCdcbmltcG9ydCB7IGdldERhdGFMb2FkZXIgfSBmcm9tICcuLi8uLi9kYXRhbG9hZGVyJ1xuaW1wb3J0IGRlbGV0ZU9wZXJhdGlvbiBmcm9tICcuLi9kZWxldGUnXG5pbXBvcnQgZGVsZXRlQnlJRCBmcm9tICcuLi9kZWxldGVCeUlEJ1xuXG5leHBvcnQgdHlwZSBCYXNlT3B0aW9uczxUIGV4dGVuZHMga2V5b2YgR2VuZXJhdGVkVHlwZXNbJ2NvbGxlY3Rpb25zJ10+ID0ge1xuICBjb2xsZWN0aW9uOiBUXG4gIC8qKlxuICAgKiBjb250ZXh0LCB3aGljaCB3aWxsIHRoZW4gYmUgcGFzc2VkIHRvIHJlcS5jb250ZXh0LCB3aGljaCBjYW4gYmUgcmVhZCBieSBob29rc1xuICAgKi9cbiAgY29udGV4dD86IFJlcXVlc3RDb250ZXh0XG4gIGRlcHRoPzogbnVtYmVyXG4gIGZhbGxiYWNrTG9jYWxlPzogc3RyaW5nXG4gIGxvY2FsZT86IHN0cmluZ1xuICBvdmVycmlkZUFjY2Vzcz86IGJvb2xlYW5cbiAgcmVxPzogUGF5bG9hZFJlcXVlc3RcbiAgc2hvd0hpZGRlbkZpZWxkcz86IGJvb2xlYW5cbiAgdXNlcj86IERvY3VtZW50XG59XG5cbmV4cG9ydCB0eXBlIEJ5SURPcHRpb25zPFQgZXh0ZW5kcyBrZXlvZiBHZW5lcmF0ZWRUeXBlc1snY29sbGVjdGlvbnMnXT4gPSBCYXNlT3B0aW9uczxUPiAmIHtcbiAgaWQ6IG51bWJlciB8IHN0cmluZ1xuICB3aGVyZT86IG5ldmVyXG59XG5cbmV4cG9ydCB0eXBlIE1hbnlPcHRpb25zPFQgZXh0ZW5kcyBrZXlvZiBHZW5lcmF0ZWRUeXBlc1snY29sbGVjdGlvbnMnXT4gPSBCYXNlT3B0aW9uczxUPiAmIHtcbiAgaWQ/OiBuZXZlclxuICB3aGVyZTogV2hlcmVcbn1cblxuZXhwb3J0IHR5cGUgT3B0aW9uczxUU2x1ZyBleHRlbmRzIGtleW9mIEdlbmVyYXRlZFR5cGVzWydjb2xsZWN0aW9ucyddPiA9XG4gIHwgQnlJRE9wdGlvbnM8VFNsdWc+XG4gIHwgTWFueU9wdGlvbnM8VFNsdWc+XG5cbmFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUxvY2FsPFRTbHVnIGV4dGVuZHMga2V5b2YgR2VuZXJhdGVkVHlwZXNbJ2NvbGxlY3Rpb25zJ10+KFxuICBwYXlsb2FkOiBQYXlsb2FkLFxuICBvcHRpb25zOiBCeUlET3B0aW9uczxUU2x1Zz4sXG4pOiBQcm9taXNlPEdlbmVyYXRlZFR5cGVzWydjb2xsZWN0aW9ucyddW1RTbHVnXT5cbmFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUxvY2FsPFRTbHVnIGV4dGVuZHMga2V5b2YgR2VuZXJhdGVkVHlwZXNbJ2NvbGxlY3Rpb25zJ10+KFxuICBwYXlsb2FkOiBQYXlsb2FkLFxuICBvcHRpb25zOiBNYW55T3B0aW9uczxUU2x1Zz4sXG4pOiBQcm9taXNlPEJ1bGtPcGVyYXRpb25SZXN1bHQ8VFNsdWc+PlxuYXN5bmMgZnVuY3Rpb24gZGVsZXRlTG9jYWw8VFNsdWcgZXh0ZW5kcyBrZXlvZiBHZW5lcmF0ZWRUeXBlc1snY29sbGVjdGlvbnMnXT4oXG4gIHBheWxvYWQ6IFBheWxvYWQsXG4gIG9wdGlvbnM6IE9wdGlvbnM8VFNsdWc+LFxuKTogUHJvbWlzZTxCdWxrT3BlcmF0aW9uUmVzdWx0PFRTbHVnPiB8IEdlbmVyYXRlZFR5cGVzWydjb2xsZWN0aW9ucyddW1RTbHVnXT5cbmFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUxvY2FsPFRTbHVnIGV4dGVuZHMga2V5b2YgR2VuZXJhdGVkVHlwZXNbJ2NvbGxlY3Rpb25zJ10+KFxuICBwYXlsb2FkOiBQYXlsb2FkLFxuICBvcHRpb25zOiBPcHRpb25zPFRTbHVnPixcbik6IFByb21pc2U8QnVsa09wZXJhdGlvblJlc3VsdDxUU2x1Zz4gfCBHZW5lcmF0ZWRUeXBlc1snY29sbGVjdGlvbnMnXVtUU2x1Z10+IHtcbiAgY29uc3Qge1xuICAgIGlkLFxuICAgIGNvbGxlY3Rpb246IGNvbGxlY3Rpb25TbHVnLFxuICAgIGNvbnRleHQsXG4gICAgZGVwdGgsXG4gICAgZmFsbGJhY2tMb2NhbGU6IGZhbGxiYWNrTG9jYWxlQXJnID0gb3B0aW9ucz8ucmVxPy5mYWxsYmFja0xvY2FsZSxcbiAgICBsb2NhbGU6IGxvY2FsZUFyZyA9IG51bGwsXG4gICAgb3ZlcnJpZGVBY2Nlc3MgPSB0cnVlLFxuICAgIHJlcTogaW5jb21pbmdSZXEgPSB7fSBhcyBQYXlsb2FkUmVxdWVzdCxcbiAgICBzaG93SGlkZGVuRmllbGRzLFxuICAgIHVzZXIsXG4gICAgd2hlcmUsXG4gIH0gPSBvcHRpb25zXG5cbiAgY29uc3QgY29sbGVjdGlvbiA9IHBheWxvYWQuY29sbGVjdGlvbnNbY29sbGVjdGlvblNsdWddXG4gIGNvbnN0IGxvY2FsaXphdGlvbkNvbmZpZyA9IHBheWxvYWQ/LmNvbmZpZz8ubG9jYWxpemF0aW9uXG4gIGNvbnN0IGRlZmF1bHRMb2NhbGUgPSBsb2NhbGl6YXRpb25Db25maWcgPyBsb2NhbGl6YXRpb25Db25maWcuZGVmYXVsdExvY2FsZSA6IG51bGxcbiAgY29uc3QgbG9jYWxlID0gbG9jYWxlQXJnIHx8IGluY29taW5nUmVxPy5sb2NhbGUgfHwgZGVmYXVsdExvY2FsZVxuICBjb25zdCBmYWxsYmFja0xvY2FsZSA9IGxvY2FsaXphdGlvbkNvbmZpZ1xuICAgID8gbG9jYWxpemF0aW9uQ29uZmlnLmxvY2FsZXMuZmluZCgoeyBjb2RlIH0pID0+IGxvY2FsZSA9PT0gY29kZSk/LmZhbGxiYWNrTG9jYWxlXG4gICAgOiBudWxsXG5cbiAgaWYgKCFjb2xsZWN0aW9uKSB7XG4gICAgdGhyb3cgbmV3IEFQSUVycm9yKFxuICAgICAgYFRoZSBjb2xsZWN0aW9uIHdpdGggc2x1ZyAke1N0cmluZyhjb2xsZWN0aW9uU2x1Zyl9IGNhbid0IGJlIGZvdW5kLiBEZWxldGUgT3BlcmF0aW9uLmAsXG4gICAgKVxuICB9XG5cbiAgY29uc3QgcmVxID0ge1xuICAgIGZhbGxiYWNrTG9jYWxlOlxuICAgICAgdHlwZW9mIGZhbGxiYWNrTG9jYWxlQXJnICE9PSAndW5kZWZpbmVkJ1xuICAgICAgICA/IGZhbGxiYWNrTG9jYWxlQXJnXG4gICAgICAgIDogZmFsbGJhY2tMb2NhbGUgfHwgZGVmYXVsdExvY2FsZSxcbiAgICBpMThuOiBpMThuSW5pdChwYXlsb2FkLmNvbmZpZy5pMThuKSxcbiAgICBsb2NhbGU6IGxvY2FsZSxcbiAgICBwYXlsb2FkLFxuICAgIHBheWxvYWRBUEk6ICdsb2NhbCcsXG4gICAgdHJhbnNhY3Rpb25JRDogaW5jb21pbmdSZXE/LnRyYW5zYWN0aW9uSUQsXG4gICAgdXNlcixcbiAgfSBhcyBQYXlsb2FkUmVxdWVzdFxuICBzZXRSZXF1ZXN0Q29udGV4dChyZXEsIGNvbnRleHQpXG5cbiAgaWYgKCFyZXEudCkgcmVxLnQgPSByZXEuaTE4bi50XG4gIGlmICghcmVxLnBheWxvYWREYXRhTG9hZGVyKSByZXEucGF5bG9hZERhdGFMb2FkZXIgPSBnZXREYXRhTG9hZGVyKHJlcSlcblxuICBjb25zdCBhcmdzID0ge1xuICAgIGlkLFxuICAgIGNvbGxlY3Rpb24sXG4gICAgZGVwdGgsXG4gICAgb3ZlcnJpZGVBY2Nlc3MsXG4gICAgcmVxLFxuICAgIHNob3dIaWRkZW5GaWVsZHMsXG4gICAgd2hlcmUsXG4gIH1cblxuICBpZiAob3B0aW9ucy5pZCkge1xuICAgIHJldHVybiBkZWxldGVCeUlEPFRTbHVnPihhcmdzKVxuICB9XG4gIHJldHVybiBkZWxldGVPcGVyYXRpb248VFNsdWc+KGFyZ3MpXG59XG5cbmV4cG9ydCBkZWZhdWx0IGRlbGV0ZUxvY2FsXG4iXSwibmFtZXMiOlsiZGVsZXRlTG9jYWwiLCJwYXlsb2FkIiwib3B0aW9ucyIsImlkIiwiY29sbGVjdGlvbiIsImNvbGxlY3Rpb25TbHVnIiwiY29udGV4dCIsImRlcHRoIiwiZmFsbGJhY2tMb2NhbGUiLCJmYWxsYmFja0xvY2FsZUFyZyIsInJlcSIsImxvY2FsZSIsImxvY2FsZUFyZyIsIm92ZXJyaWRlQWNjZXNzIiwiaW5jb21pbmdSZXEiLCJzaG93SGlkZGVuRmllbGRzIiwidXNlciIsIndoZXJlIiwiY29sbGVjdGlvbnMiLCJsb2NhbGl6YXRpb25Db25maWciLCJjb25maWciLCJsb2NhbGl6YXRpb24iLCJkZWZhdWx0TG9jYWxlIiwibG9jYWxlcyIsImZpbmQiLCJjb2RlIiwiQVBJRXJyb3IiLCJTdHJpbmciLCJpMThuIiwiaTE4bkluaXQiLCJwYXlsb2FkQVBJIiwidHJhbnNhY3Rpb25JRCIsInNldFJlcXVlc3RDb250ZXh0IiwidCIsInBheWxvYWREYXRhTG9hZGVyIiwiZ2V0RGF0YUxvYWRlciIsImFyZ3MiLCJkZWxldGVCeUlEIiwiZGVsZXRlT3BlcmF0aW9uIl0sIm1hcHBpbmdzIjoiOzs7OytCQXVIQTs7O2VBQUE7Ozt3QkFqSHlCO21DQUNTO3NCQUNUOzRCQUNLOytEQUNGO21FQUNMOzs7Ozs7QUEyQ3ZCLGVBQWVBLFlBQ2JDLE9BQWdCLEVBQ2hCQyxPQUF1QjtJQUV2QixNQUFNLEVBQ0pDLEVBQUUsRUFDRkMsWUFBWUMsY0FBYyxFQUMxQkMsT0FBTyxFQUNQQyxLQUFLLEVBQ0xDLGdCQUFnQkMsb0JBQW9CUCxTQUFTUSxLQUFLRixjQUFjLEVBQ2hFRyxRQUFRQyxZQUFZLElBQUksRUFDeEJDLGlCQUFpQixJQUFJLEVBQ3JCSCxLQUFLSSxjQUFjLENBQUMsQ0FBbUIsRUFDdkNDLGdCQUFnQixFQUNoQkMsSUFBSSxFQUNKQyxLQUFLLEVBQ04sR0FBR2Y7SUFFSixNQUFNRSxhQUFhSCxRQUFRaUIsV0FBVyxDQUFDYixlQUFlO0lBQ3RELE1BQU1jLHFCQUFxQmxCLFNBQVNtQixRQUFRQztJQUM1QyxNQUFNQyxnQkFBZ0JILHFCQUFxQkEsbUJBQW1CRyxhQUFhLEdBQUc7SUFDOUUsTUFBTVgsU0FBU0MsYUFBYUUsYUFBYUgsVUFBVVc7SUFDbkQsTUFBTWQsaUJBQWlCVyxxQkFDbkJBLG1CQUFtQkksT0FBTyxDQUFDQyxJQUFJLENBQUMsQ0FBQyxFQUFFQyxJQUFJLEVBQUUsR0FBS2QsV0FBV2MsT0FBT2pCLGlCQUNoRTtJQUVKLElBQUksQ0FBQ0osWUFBWTtRQUNmLE1BQU0sSUFBSXNCLGdCQUFRLENBQ2hCLENBQUMseUJBQXlCLEVBQUVDLE9BQU90QixnQkFBZ0Isa0NBQWtDLENBQUM7SUFFMUY7SUFFQSxNQUFNSyxNQUFNO1FBQ1ZGLGdCQUNFLE9BQU9DLHNCQUFzQixjQUN6QkEsb0JBQ0FELGtCQUFrQmM7UUFDeEJNLE1BQU1DLElBQUFBLGNBQVEsRUFBQzVCLFFBQVFtQixNQUFNLENBQUNRLElBQUk7UUFDbENqQixRQUFRQTtRQUNSVjtRQUNBNkIsWUFBWTtRQUNaQyxlQUFlakIsYUFBYWlCO1FBQzVCZjtJQUNGO0lBQ0FnQixJQUFBQSxvQ0FBaUIsRUFBQ3RCLEtBQUtKO0lBRXZCLElBQUksQ0FBQ0ksSUFBSXVCLENBQUMsRUFBRXZCLElBQUl1QixDQUFDLEdBQUd2QixJQUFJa0IsSUFBSSxDQUFDSyxDQUFDO0lBQzlCLElBQUksQ0FBQ3ZCLElBQUl3QixpQkFBaUIsRUFBRXhCLElBQUl3QixpQkFBaUIsR0FBR0MsSUFBQUEseUJBQWEsRUFBQ3pCO0lBRWxFLE1BQU0wQixPQUFPO1FBQ1hqQztRQUNBQztRQUNBRztRQUNBTTtRQUNBSDtRQUNBSztRQUNBRTtJQUNGO0lBRUEsSUFBSWYsUUFBUUMsRUFBRSxFQUFFO1FBQ2QsT0FBT2tDLElBQUFBLG1CQUFVLEVBQVFEO0lBQzNCO0lBQ0EsT0FBT0UsSUFBQUEsZUFBZSxFQUFRRjtBQUNoQztNQUVBLFdBQWVwQyJ9